{"version":3,"sources":["modules/demo_instant_messaging.js"],"names":["selfEasyrtcid","addToConversation","who","msgType","content","replace","document","getElementById","innerHTML","connect","easyrtc","setPeerListener","setRoomOccupantListener","convertListToButtons","loginSuccess","loginFailure","roomName","occupants","isPrimary","otherClientDiv","hasChildNodes","removeChild","lastChild","easyrtcid","button","createElement","onclick","sendStuffWS","label","createTextNode","idToName","appendChild","otherEasyrtcid","text","value","length","sendDataWS","errorCode","message","showError","console","log","addEventListener"],"mappings":"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","file":"demo_instant_messaging.fa71fb9b.map","sourceRoot":"..","sourcesContent":["//\n//Copyright (c) 2016, Skedans Systems, Inc.\n//All rights reserved.\n//\n//Redistribution and use in source and binary forms, with or without\n//modification, are permitted provided that the following conditions are met:\n//\n//  * Redistributions of source code must retain the above copyright notice,\n//    this list of conditions and the following disclaimer.\n//  * Redistributions in binary form must reproduce the above copyright\n//    notice, this list of conditions and the following disclaimer in the\n//    documentation and/or other materials provided with the distribution.\n//\n//THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n//AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n//IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n//ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n//LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n//CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n//SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n//INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n//CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n//ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n//POSSIBILITY OF SUCH DAMAGE.\n//\nvar selfEasyrtcid = \"\";\nfunction addToConversation(who, msgType, content) {\n  // Escape html special characters, then add linefeeds.\n  content = content.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\");\n  content = content.replace(/\\n/g, \"<br />\");\n  document.getElementById(\"conversation\").innerHTML +=\n  \"<b>\" + who + \":</b>&nbsp;\" + content + \"<br />\";\n}\n \n \nfunction connect() {\n  easyrtc.setPeerListener(addToConversation);\n  easyrtc.setRoomOccupantListener(convertListToButtons);\n  easyrtc.connect(\"easyrtc.instantMessaging\", loginSuccess, loginFailure);\n}\n \n \nfunction convertListToButtons (roomName, occupants, isPrimary) {\n  var otherClientDiv = document.getElementById(\"otherClients\");\n  while (otherClientDiv.hasChildNodes()) {\n    otherClientDiv.removeChild(otherClientDiv.lastChild);\n  }\n \n  for(var easyrtcid in occupants) {\n    var button = document.createElement(\"button\");\n    button.onclick = function(easyrtcid) {\n      return function() {\n        sendStuffWS(easyrtcid);\n      };\n    }(easyrtcid);\n    var label = document.createTextNode(\"Send to \" + easyrtc.idToName(easyrtcid));\n    button.appendChild(label);\n \n    otherClientDiv.appendChild(button);\n  }\n  if( !otherClientDiv.hasChildNodes() ) {\n    otherClientDiv.innerHTML = \"<em>Nobody else logged in to talk to...</em>\";\n  }\n}\n \n \nfunction sendStuffWS(otherEasyrtcid) {\n  var text = document.getElementById(\"sendMessageText\").value;\n  if(text.replace(/\\s/g, \"\").length === 0) { // Don\"t send just whitespace\n    return;\n  }\n \n  easyrtc.sendDataWS(otherEasyrtcid, \"message\",  text);\n  addToConversation(\"Me\", \"message\", text);\n  document.getElementById(\"sendMessageText\").value = \"\";\n}\n \n \nfunction loginSuccess(easyrtcid) {\n  selfEasyrtcid = easyrtcid;\n  document.getElementById(\"iam\").innerHTML = \"I am \" + easyrtcid;\n}\n \n \nfunction loginFailure(errorCode, message) {\n  easyrtc.showError(errorCode, message);\n}\nconsole.log('aaa')\ndocument.addEventListener('DOMContentLoaded', connect)"]}